<div class="flex w-full">
  <div class="flex-1 bg-cyan-500 p-4">
  </div>
  <div class="flex-2 bg-green p-4">
  </div>
  <div class="flex-1 bg-red p-4">
  </div>
</div>

<div class="flex w-full">
  <div class="flex bg-white p-4">
  </div>
</div>

<form *ngIf="state() as state"
      (ngSubmit)="onSubmit()" #myForm="ngForm"
      class="flex min-h-screen flex-col flex-cols-3 md:flex-row gap-4 justify-center bg-cyan-500 p-16">
  <div class="flex flex-col">
<!--    <h1 class="text-3xl font-bold text-white">Your tests</h1>-->
  </div>
  <div class="flex-2 flex-col">
    <h1 class="text-3xl font-bold text-white">pump your brain with lekAI</h1>
    <p class="mb-8 font-semibold text-gray-100">created by Kastus</p>
    <div class="w-full rounded-xl bg-white p-4 shadow-2xl shadow-white/40">

      <!--   CHOOSE YOUR LEVEL   -->
      <section class="w-full flex flex-col mb-6">
        <legend class="mb-3 font-semibold">Choose your level of knowledge</legend>
        <div class="w-full flex flex-wrap flex-row flex-start gap-2">
          <ng-container *ngFor="let knowledgeLevel of knowledgeLevels | keyvalue">
            <div *ngIf="{ isSelected: knowledgeLevel.value === state.selectedKnowledgeLevel } as data"
                 (click)="selectKnowledgeLevel(knowledgeLevel.value)"
                 [ngClass]="{ 'border-blue': data.isSelected }"
                 class="flex items-center max-w-2xl px-8 py-4 border cursor-pointer rounded-xl">
              <div class="flex items-center">
                <svg [ngClass]="{ 'text-blue': data.isSelected, 'text-gray-400': !data.isSelected }"
                     xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 sm:h-7 sm:w-7" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                </svg>
                <div class="flex flex-col items-center mx-5 space-y-1">
                  <h2 class="text-lg font-medium text-gray-700 sm:text-2xl">
                    {{ knowledgeLevel.value }}
                  </h2>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </section>

      <!--   PICK YOUR LANGUAGE   -->
      <fieldset class="mb-6">
        <legend class="mb-3 font-semibold">Pick a language</legend>
        <div class="flex flex-row max-w-2xl gap-4">
          <ng-container *ngFor="let language of languages | keyvalue">
            <label *ngIf="{ isSelected: language.value === state.selectedLanguage } as data"
                   (click)="selectLanguage(language.value)"
                   [ngClass]="{ 'ring-2 ring-indigo-500': data.isSelected }"
                   class="group relative flex items-center justify-center rounded-md border py-3 px-4 text-sm font-medium uppercase hover:bg-gray-50 focus:outline-none sm:flex-1 cursor-pointer bg-white text-gray-900 shadow-sm">
              <input type="radio" name="size-choice" value="XXS" class="sr-only" aria-labelledby="size-choice-0-label">
              <span id="size-choice-0-label">
                {{ language.value }}
              </span>
              <span [ngClass]="{ 'border-indigo-500': data.isSelected, 'border-transparent': !data.isSelected }"
                    class="pointer-events-none absolute -inset-px rounded-md" aria-hidden="true"></span>
            </label>
          </ng-container>

          <!-- Active: "ring-2 ring-indigo-500" -->
          <label class="group relative flex items-center justify-center rounded-md border py-3 px-4 text-sm font-medium uppercase hover:bg-gray-50 focus:outline-none sm:flex-1 cursor-not-allowed bg-gray-50 text-gray-200">
            <input type="radio" name="size-choice" value="XXXL" disabled class="sr-only" aria-labelledby="size-choice-7-label">
            <span id="size-choice-7-label">More soon</span>
            <span aria-hidden="true" class="pointer-events-none absolute -inset-px rounded-md border-2 border-gray-200">
              <svg class="absolute inset-0 h-full w-full stroke-2 text-gray-200" viewBox="0 0 100 100" preserveAspectRatio="none" stroke="currentColor">
                <line x1="0" y1="100" x2="100" y2="0" vector-effect="non-scaling-stroke" />
              </svg>
            </span>
          </label>
        </div>
      </fieldset>

      <!--   FAV TOPICS   -->
      <fieldset class="mb-6">
        <legend class="mb-3 font-semibold">Fav topics</legend>
        <div class="flex flex-wrap flex-row md:flex-column gap-6">
          <ng-container *ngFor="let favTopic of favoriteTopics; let index = index">
            <div class="relative flex gap-x-3">
              <div class="flex h-6 items-center">
                <input [(ngModel)]="form.favoriteTopics[index].selected"
                       [id]="'favoriteTopics-' + favTopic.id"
                       [name]="'favoriteTopics-' + favTopic.id"
                       type="checkbox"
                       class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600">
              </div>
              <div class="text-sm leading-6">
                <label [for]="'favoriteTopics-' + favTopic.id" class="font-medium text-gray-900">
                  {{ favTopic.value }}
                </label>
              </div>
            </div>
          </ng-container>
        </div>
      </fieldset>

      <!--   RADIO BUTTONS   -->
      <fieldset class="border-b border-gray-900/10 pb-6">
        <legend class="mb-3 font-semibold">Type of the exercise</legend>
        <div class="flex flex-wrap flex-row md:flex-column gap-6">
          <ng-container *ngFor="let exercise of exerciseTypes; let index = index">
            <div class="flex items-center gap-x-3">
              <input [(ngModel)]="form.exerciseType"
                     [value]="exercise.id"
                     [id]="'exerciseTypes-' + exercise.id"
                     [name]="'exerciseTypes'"
                     type="radio"
                     class="h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-600">
              <label [for]="'exerciseTypes-' + exercise.id" class="block text-sm font-medium leading-6 text-gray-900">
                {{ exercise.value }}
              </label>
            </div>
          </ng-container>
        </div>
      </fieldset>
      <!--   SUBMIT BUTTONS   -->
      <div class="mt-6 flex items-center justify-end gap-x-6">
        <button type="submit"
                [disabled]="state.isLoading"
                class="rounded-md bg-blue px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Get a test</button>
      </div>
    </div>
  </div>
  <div class="flex flex-col">
    <h1 class="text-3xl font-bold text-white">
      {{ state.initialLoad ? 'Example of the test' : 'Your test' }}
    </h1>
    <p class="mb-8 font-semibold text-gray-100">
      {{ state.testDescription }}
    </p>

    <div *ngIf="state.exercise as exercise"
         [ngClass]="{ 'text-gray-300': state.isLoading }"
         class="w-full rounded-xl bg-white p-4 shadow-2xl shadow-white/40">
      <div *ngIf="state.isLoading"
           class="mt-6 mx-auto loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-32 w-32"></div>

      <div class="p-4" *ngFor="let question of exercise; let i = index;">
        <p class="mb-2">{{ question.sentence }}</p>
        <div *ngFor="let option of question.options; let j = index;">
          <input type="radio" id="option{{i}}{{j}}" name="question{{i}}" value="{{option}}" class="mr-2" #inputOption>
          <label [ngClass]="{ 'text-green': question.isRevealed && question.answer === inputOption.value }"
                 [ngClass]="{ 'text-red': question.isRevealed && question.answer !== inputOption.value }"
                 for="option{{i}}{{j}}" class="mr-4">{{ option }}</label>
        </div>
      </div>

      <div class="mt-6 flex items-center justify-end gap-x-6">
        <button [disabled]="state.isLoading"
                (click)="checkTest()"
                type="button"
                class="rounded-md bg-blue px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Check</button>
      </div>
    </div>
  </div>
</form>
